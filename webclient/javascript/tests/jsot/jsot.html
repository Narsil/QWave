<html>
<head>
<title>JavaScript OT</title>
<script src="../../jsot.js" type="text/javascript"></script>
</head>
<body>
	<h1>Hello world</h1>
	<div id="out"></div>
	<script type="text/javascript">
var doc = new JSOT.Doc();
doc.content.push("Hallo!");

var ops = new JSOT.DocOp();
ops.component.push( new JSOT.DocOp.newAnnotationBoundary( [], [ new JSOT.DocOp.newKeyValueUpdate( "bold", null, "true" ) ] ) );
ops.component.push( new JSOT.DocOp.newRetainItemCount(5) );
ops.component.push( new JSOT.DocOp.newAnnotationBoundary( [ "bold" ], [ ] ) );
ops.component.push( new JSOT.DocOp.newCharacters(" ") );
ops.component.push( new JSOT.DocOp.newElementStart("b") );
ops.component.push( new JSOT.DocOp.newAnnotationBoundary( [], [ new JSOT.DocOp.newKeyValueUpdate( "italic", null, "true" ) ] ) );
ops.component.push( new JSOT.DocOp.newCharacters("Welt") );
ops.component.push( new JSOT.DocOp.newAnnotationBoundary( [ "italic" ], [ ] ) );
ops.component.push( new JSOT.DocOp.newElementEnd() );
ops.component.push( new JSOT.DocOp.newRetainItemCount(1) );
ops.component.push( new JSOT.DocOp.newCharacters(" Bye.") );

ops.applyTo(doc);

var result = doc.toString();
document.getElementById("out").appendChild( document.createTextNode(result) );

ops = new JSOT.DocOp();
ops.component.push( new JSOT.DocOp.newRetainItemCount(6) );
ops.component.push( new JSOT.DocOp.newReplaceAttributes( { }, { foo : "bar", "remove" : "me" } ) );
ops.component.push( new JSOT.DocOp.newRetainItemCount(11) );

ops.applyTo(doc);

result = doc.toString();
document.getElementById("out").appendChild( document.createTextNode(result) );

ops = new JSOT.DocOp();
ops.component.push( new JSOT.DocOp.newRetainItemCount(6) );
ops.component.push( new JSOT.DocOp.newUpdateAttributes( [ new JSOT.DocOp.newKeyValueUpdate( "foo", "bar", "bar2" ), new JSOT.DocOp.newKeyValueUpdate( "remove", "me", null ) ] ) );
ops.component.push( new JSOT.DocOp.newRetainItemCount(11) );

ops.applyTo(doc);

result = doc.toString();
document.getElementById("out").appendChild( document.createTextNode(result) );

ops = new JSOT.DocOp();
ops.component.push( new JSOT.DocOp.newRetainItemCount(6) );
ops.component.push( new JSOT.DocOp.newReplaceAttributes( { foo : "bar2" }, { xfoo : "Xbar", name : "Joe" } ) );
ops.component.push( new JSOT.DocOp.newRetainItemCount(11) );

ops.applyTo(doc);

result = doc.toString();
document.getElementById("out").appendChild( document.createTextNode(result) );

ops = new JSOT.DocOp();
ops.component.push( new JSOT.DocOp.newRetainItemCount(2) );
ops.component.push( new JSOT.DocOp.newDeleteCharacters("ll") );
ops.component.push( new JSOT.DocOp.newRetainItemCount(2) );
ops.component.push( new JSOT.DocOp.newDeleteElementStart("b", { xfoo : "Xbar", name : "Joe" }) );
ops.component.push( new JSOT.DocOp.newDeleteCharacters("Welt") );
ops.component.push( new JSOT.DocOp.newDeleteElementEnd("b") );
ops.component.push( new JSOT.DocOp.newRetainItemCount(7) );

ops.applyTo(doc);

result = doc.toString();
document.getElementById("out").appendChild( document.createTextNode(result) );

ops = new JSOT.DocOp();
ops.component.push( new JSOT.DocOp.newDeleteCharacters("Hao ! Bye.") );

ops.applyTo(doc);

result = doc.toString();
document.getElementById("out").appendChild( document.createTextNode(">>" + result + "<<") );

document.getElementById("out").appendChild( document.createTextNode( doc.content.length.toString() ) );

	</script>
</body>
</html>